/** @license: OpenAdViewability (BSD-3 License): https://github.com/picatcha/OpenAdViewability/ */
!function(){"use strict";function t(){var t={percentObscured:0,percentViewable:0,acceptedViewablePercentage:50,viewabilityStatus:!1,duration:0};this.DEBUG_MODE=!1,this.checkViewability=function(e,o){function a(){r(e)||(u=c(),i());var n=c()-u,h=n>=1e3;t.duration=n,h?(t.viewabilityStatus=!0,d.DEBUG_MODE||window.cancelAFrame(l)):l=window.requestAnimFrame(a),o(t)}function c(){return"object"===n(window.performance)?window.performance.now():(new Date).getTime()}var u=c(),d=this,l=window.requestAnimFrame(a)};var i=function(){t.percentObscured=0,t.duration=0,t.viewabilityStatus=!1},r=function(e){var n=e.getBoundingClientRect(),i=n.width*n.height;if(i>=242500&&(t.acceptedViewablePercentage=30),a(e))return!1;if(c(e))return!1;var r=o(e);return!r.error&&(!(t.percentViewable&&t.percentViewable<t.acceptedViewablePercentage)&&t.percentViewable)},o=function(n){var i=new e;t.percentObscured=t.percentObscured||0;var r=i.getViewabilityState(n,window);return r.error||(t.percentViewable=r.percentViewable-t.percentObscured),r},a=function(t){var e=window.getComputedStyle(t,null),n=e.getPropertyValue("visibility"),i=e.getPropertyValue("display");return"hidden"===n||"none"===i},c=function(e){var n=e.getBoundingClientRect(),i=12,r=n.left+i,o=n.right-i,a=Math.max(0,n.top+i),c=n.bottom-i,l=Math.floor(n.left+n.width/2),f=Math.floor(n.top+n.height/2),m=[{x:r,y:a},{x:l,y:a},{x:o,y:a},{x:r,y:f},{x:l,y:f},{x:o,y:f},{x:r,y:c},{x:l,y:c},{x:o,y:c}],s=[];for(var g in m)if(m.hasOwnProperty(g)&&m[g]&&m[g].x>=0&&m[g].y>=0){var p=document.elementFromPoint(m[g].x,m[g].y);if(d(e,p)){var b=p.getBoundingClientRect();if(n.top>b.bottom)continue;var v=h(n,b);if(v>0&&(u(s,p)||s.push({el:p,area:v}),t.percentObscured>100-t.acceptedViewablePercentage))return!0}}return t.percentObscured=s.length>0?100*s.map(function(t){return t.area}).reduce(function(t,e){return Math.max(t,e)}):0,t.percentViewable=100-t.percentObscured,!1},u=function(t,e){return t.length>0&&t.map(function(t){return t.el}).some(function(t){return t===e})},d=function(t,e){return null!==e&&t!==e&&!t.contains(e)&&!e.contains(t)&&!l(t,e)},l=function(t,e){var n=e.nodeName,i=window.getComputedStyle(e,null),r=t.getBoundingClientRect(),o=e.getBoundingClientRect(),a=r.top===o.top&&r.bottom===o.bottom&&r.left===o.left&&r.right===o.right&&r.height===o.height&&r.width===o.width;return 0===e.childNodes.length&&("DIV"===n||"SPAN"===n)&&"none"===i.backgroundImage&&"none"===i.borderStyle&&"rgba(0, 0, 0, 0)"===i.backgroundColor&&a},h=function(t,e){var n=t.width*t.height,i=Math.max(0,Math.min(t.right,e.right)-Math.max(t.left,e.left)),r=Math.max(0,Math.min(t.bottom,e.bottom)-Math.max(t.top,e.top));return i*r/n}}function e(){this.getViewabilityState=function(i,r){var o,a=t();if(a.area===1/0)return{error:"Failed to determine viewport"};var c=i.getBoundingClientRect(),u=c.width*c.height,d=e(window.top),l=n(i,r);return a.area/u<.5?o=Math.floor(100*a.area/u):(l.bottom>d.height&&(l.height-=l.bottom-d.height),l.top<0&&(l.height+=l.top),l.left<0&&(l.width+=l.left),l.right>d.width&&(l.width-=l.right-d.width),o=Math.floor(100*(l.width*l.height)/u)),{clientWidth:d.width,clientHeight:d.height,objTop:c.top,objBottom:c.bottom,objLeft:c.left,objRight:c.right,percentViewable:o}};var t=function(){for(var t=e(window),n=t.area,i=window;i!==window.top;){i=i.parent;var r=e(i);r.area<n&&(n=r.area,t=r)}return t},e=function(t){var e={width:1/0,height:1/0,area:1/0};return!isNaN(t.document.body.clientWidth)&&t.document.body.clientWidth>0&&(e.width=t.document.body.clientWidth),!isNaN(t.document.body.clientHeight)&&t.document.body.clientHeight>0&&(e.height=t.document.body.clientHeight),t.document.documentElement&&t.document.documentElement.clientWidth&&!isNaN(t.document.documentElement.clientWidth)&&(e.width=t.document.documentElement.clientWidth),t.document.documentElement&&t.document.documentElement.clientHeight&&!isNaN(t.document.documentElement.clientHeight)&&(e.height=t.document.documentElement.clientHeight),t.innerWidth&&!isNaN(t.innerWidth)&&(e.width=Math.min(e.width,t.innerWidth)),t.innerHeight&&!isNaN(t.innerHeight)&&(e.height=Math.min(e.height,t.innerHeight)),e.area=e.height*e.width,e},n=function t(e,n){var r=n,o=n.parent,a={width:0,height:0,left:0,right:0,top:0,bottom:0};if(e){var c=i(e,n);if(c.width=c.right-c.left,c.height=c.bottom-c.top,a=c,r!==o){var u=t(r.frameElement,o);u.bottom<a.bottom&&(u.bottom<a.top&&(a.top=u.bottom),a.bottom=u.bottom),u.right<a.right&&(u.right<a.left&&(a.left=u.right),a.right=u.right),a.width=a.right-a.left,a.height=a.bottom-a.top}}return a},i=function t(e,n){var i=n,r=n.parent,o={left:0,right:0,top:0,bottom:0};if(e){var a=e.getBoundingClientRect();i!==r&&(o=t(i.frameElement,r)),o={left:a.left+o.left,right:a.right+o.left,top:a.top+o.top,bottom:a.bottom+o.top}}return o}}var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t,e,n){function i(){R||"loading"===e.readyState||(R=!0,t.setTimeout(function(){r(e)},0))}function r(t){var e,n,i=[],r=[],a=t.querySelectorAll("ins.adsbyfalcon");for(e=0,n=a.length;e<n;e++){var l,h,f=a[e],m=f.getAttribute("data-ad-slot"),g=O(f.getAttribute("data-ad-sizes")),p=f.getAttribute("data-merge-position"),b=f.offsetWidth||0,v=f.offsetHeight||0;if(m&&!S(f)&&!A(f)){if(i.push(m),g&&(l=c(u(g)).sort(d),h=o(l),m=h?h.slot:m),2199==m||1101==m){var w=[{id:m,width:b,height:v,element:f,mergePosition:p}];x(f),s(w);continue}r.push({id:m,width:b,height:v,element:f,mergePosition:p}),x(f)}}i.length&&s(r)}function o(t){var e,n,i=a().width;if(n=t.filter(function(t){return i>=t.width}),1===n.length)return n=t.reverse().slice(0,2),n=n.filter(function(t){return{}.hasOwnProperty.call(t,"slot")}),n[0];var r,o,c=n.findIndex(function(t){return!t.slot&&t.width===i}),u=c-1,d=c+1,l=t[c].width;return 0===c?e=n[1]:n.length-1===c?e=n[u]:(r=n[u].width,o=n[d].width,e=Math.abs(o-l)<Math.abs(r-l)?n[d]:n[u]),e}function a(){var n=Math.max(t.innerWidth,e.documentElement.clientWidth),i=Math.max(t.innerHeight,e.documentElement.clientHeight);return 793<=n&&n<=807&&(n=800),1017<=n&&n<=1031&&(n=1024),{width:n,height:i}}function c(t){var e=a();return t.concat([e])}function u(t){var e,n=[];for(e in t)t.hasOwnProperty(e)&&n.push({resolution:e,slot:t[e],width:Math.floor(e.match(/^\d+/)[0]),height:Math.floor(e.match(/\d+$/)[0])});return n}function d(t,e){return t.width!==e.width?e.width>t.width?1:e.width<t.width?-1:0:e.height>t.height?1:e.height<t.height?-1:0}function l(n,i){for(;i.length;){var r=i.shift(),o=n.shift();if(o&&!A(o.element)){if(0===r.ad_num){o.element.parentNode.removeChild(o.element),"1101"!==o.id&&"2199"!==o.id||(e.querySelector("#main > .header-fixed-area").style.display="none");continue}h(o.element,o.width,o.height,r.html),E(o.element),void 0!==t.pix&&D(o.element,r)}}}function h(n,i,r,o){if("false"===n.getAttribute("data-embed"))return n.innerHTML=o,void f(n);t.pix&&n&&n.classList&&n.classList.add("pixnet-ad");var a=e.createElement("iframe"),c="margin:0;padding:0;overflow:hidden;background-color:transparent;";a.setAttribute("allowfullscreen","auto"),a.setAttribute("style",c+"border:none;width:"+i+"px;height:"+r+"px;"),a.setAttribute("scrolling","no"),n.innerHTML="",n.appendChild(a),a.contentDocument.open(),a.contentDocument.write(o),a.contentDocument.body&&a.contentDocument.body.setAttribute("style",c),a.contentDocument.close()}function f(e){if("SCRIPT"===e.tagName)return e.parentNode.replaceChild(m(e),e),e;var n=0,i=e.childNodes;for(t.pix&&"INS"===e.tagName&&e&&e.classList&&e.classList.add("pixnet-ad");n<i.length;)f(i[n++]);return e}function m(t){var n=e.createElement("script");n.text=t.innerHTML;for(var i=t.attributes.length-1;i>=0;i--)n.setAttribute(t.attributes[i].name,t.attributes[i].value);return n}function s(e){var n="20190704v1",i=L(),r=i?"&demo_ad_no="+i:"",o="https://"+w()+"/ad/json?"+b(e)+"&version=2&sdk_version="+n+"&t="+(new Date).getTime()+r+g(),a=M("falcon:blogcategory"),c=M("falcon:articlecategory");a&&(o+="&blog_category="+a),c&&(o+="&article_category="+c);var u=new XMLHttpRequest;t.XDomainRequest&&(u=new XDomainRequest,u.onprogress=function(){},u.ontimeout=function(){},u.onerror=function(){}),u.onload=function(){var t=O(this.responseText);C(t.ad_slots)&&t.ad_slots.length&&l(e,t.ad_slots)},u.addEventListener&&u.addEventListener("error",function(t){},!1),u.open("get",o,!0),u.withCredentials=!0,u.send()}function g(){var t=p("pixtag");return t?"&pixtag="+t:""}function p(t){var n="; "+e.cookie,i=n.split("; "+t+"=");return 2===i.length?i.pop().split("; ").shift():""}function b(t){for(var e="",n=[],i=0,r=t.length;i<r;i++){var o=t[i],a="";o.mergePosition&&n.indexOf(o.id)===-1&&(n.push(o.id),a="&merge_position["+o.id+"]="+o.mergePosition),e=e+v(o,a)+(i!==r-1?"&":"")}return e}function v(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return"pos[]="+t.id+","+t.width+","+t.height+e}function w(){var t=y()||"falcon";return t+".pixnet.net"}function y(){for(var t=e.getElementsByTagName("script"),n=/\/\/([^.]*falcon)-asset\.pixfs\.net/g,i=0,r=t.length;i<r;i++){var o=n.exec(t[i].getAttribute("src"));if(o)return o[1]}}function M(t){var n=e.querySelector('meta[property="'+t+'"]');return n&&n.getAttribute("content")}function S(t){return N(t,"processing")}function x(t){return q(t,"processing")}function A(t){return N(t,"done")}function E(t){return q(t,"done")}function N(t,e){return!!t&&e===t.getAttribute("data-adsbyfalcon-status")}function q(t,e){return!!t&&t.setAttribute("data-adsbyfalcon-status",e)}function O(t){try{return JSON.parse(t)}catch(t){return{}}}function _(e){if(!e)return"";for(var n=t.location,i=n.search.substring(1)||n.hash.split("?")[1]||"",r=i.split("&"),o=0;o<r.length;o++){var a=r[o].split("=");if(a[0]===e)return decodeURIComponent(a[1].replace(/\+/g," "))}return""}function L(){return"11"===_("preview_mib_fly_mobile_image_ad")?"75ecc55cd322ced48ae2d4c7717a0891":_("demo_ad_no")}function C(t){return t&&t instanceof Array}function D(t,n){var i=t.querySelector("img, iframe"),r=T(t.innerHTML),o=V(t.innerHTML);return r&&!i?void t.addEventListener("DOMSubtreeModified",function e(){i=t.querySelector("img, iframe"),i&&(D(t,n),t.removeEventListener("DOMSubtreeModified",e,!1))}):o&&!i?void t.addEventListener("DOMSubtreeModified",function e(){t.removeEventListener("DOMSubtreeModified",e,!1),H(t,n)}):i?void(0!==n.ad_list.length&&i.addEventListener("load",function e(){var o=r?t.querySelector("div[data-type]"):i;H(o,n),i.removeEventListener("load",e,!1)})):void Object.keys(t.childNodes).map(function(i){var r=t.childNodes[i];if(void 0!==r&&"SCRIPT"===r.nodeName){var o=F(r.innerHTML);if(o){var a=e.querySelector(o);if(a){t!==a.parentNode&&(a=a.parentNode);var c=a.querySelector(".adsbygoogle"),u=void 0;return c?void D(a.querySelector(".adsbygoogle"),n):(a.addEventListener("DOMSubtreeModified",function t(){return a.querySelector(".adsbygoogle img, .adsbygoogle iframe")?(D(a.querySelector(".adsbygoogle"),n),void a.removeEventListener("DOMSubtreeModified",t,!1)):void(a.querySelector("img, iframe")&&!u&&(u=!0,D(a,n)))}),void(a.querySelector("img, iframe")&&!u&&(u=!0,D(a,n))))}}}})}function H(t,e){var i=e.ad_list[0].activeview_url,r=new n;i&&r.checkViewability(t,function(t){if(t.viewabilityStatus){var e=new Image;e.src=i}})}function T(t){return!!t.match(/backdrop/)}function V(t){return!!t.match(/popIn_recommend/)}function F(t){var e=t.match(/falcon_dom = '[\w]+'/);if(e)return"#"+e[0].split("'")[1];var n=t.match(/pop-ad-cover/);if(n)return".pop-ad-cover .iframe";var i=t.match(/\).append\(/g);return i&&i.length>1?i[1].split("'")[1]:""}var P=function(){};t.console=t.console||{log:P,warn:P,error:P,dir:P},Array.prototype.findIndex||(Array.prototype.findIndex=function(t){if(null==this)throw new TypeError("Array.prototype.findIndex called on null or undefined");if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var e,n=Object(this),i=n.length>>>0,r=arguments[1],o=0;o<i;o++)if(e=n[o],t.call(r,e,o,n))return o;return-1}),Array.prototype.filter||(Array.prototype.filter=function(t){if(void 0===this||null===this)throw new TypeError;var e,n,i,r=Object(this),o=r.length>>>0,a=[];if("function"!=typeof t)throw new TypeError;for(a=[],e=arguments.length>=2?arguments[1]:void 0,n=0;n<o;n++)n in r&&(i=r[n],t.call(e,i,n,r)&&a.push(i));return a}),t.requestAnimFrame=t.requestAnimFrame||function(){return t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.oRequestAnimationFrame||t.msRequestAnimationFrame||function(e){t.setTimeout(e,1e3/60)}}(),t.cancelAFrame=function(){return t.cancelAnimationFrame||t.webkitCancelAnimationFrame||t.mozCancelAnimationFrame||t.oCancelAnimationFrame||function(e){t.clearTimeout(e)}}();var R=!1;e.addEventListener("readystatechange",i),t.PIXFalcon=function(){function t(){}return t.prototype.placeAds=function(t){var n,i,o;if(e===t)return void r(e);if(n=e.querySelectorAll(t),i=n.length,0!==i)for(o=0;o<i;o++)r(n[o])},t.prototype.placeAdByNode=function(t){r(t)},t}(),i()}(window,document,t)}();
//# sourceMappingURL=adsbyfalcon.min.js.map
